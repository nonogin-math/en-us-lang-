<!DOCTYPE html>
<html>
<head>
  <title>Grade 3 – Lessons & Tests</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f7ff;
      text-align: center;
      padding: 20px;
    }
    h1, h2, h3 {
      color: #333;
    }
    .problem {
      margin: 8px;
      font-size: 18px;
    }
    input {
      width: 60px;
      padding: 5px;
      font-size: 16px;
    }
    button {
      margin: 20px;
      padding: 10px 18px;
      font-size: 16px;
      cursor: pointer;
    }
    #score {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>Grade 3 – Lessons & Tests</h1>

<div id="content"></div>
<button onclick="checkAll()">Check All Answers</button>
<p id="score"></p>

<script>
// ---------------- Random Helpers ----------------
function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

// Generate random addition
function genAdd(count,maxSum){
  const arr=[];
  for(let i=0;i<count;i++){
    const a=rand(0,maxSum), b=rand(0,maxSum-a);
    arr.push({q:`${a} + ${b}`,a:a+b});
  }
  return arr;
}

// Generate random subtraction
function genSub(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    const a=rand(0,maxVal), b=rand(0,a);
    arr.push({q:`${a} - ${b}`,a:a-b});
  }
  return arr;
}

// Generate random multiplication
function genMul(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    const a=rand(0,maxVal), b=rand(0,maxVal);
    arr.push({q:`${a} × ${b}`,a:a*b});
  }
  return arr;
}

// Generate random division
function genDiv(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    const b=rand(1,maxVal); // divisor not zero
    const a=b*rand(0,maxVal); // dividend divisible by b
    arr.push({q:`${a} ÷ ${b}`,a:a/b});
  }
  return arr;
}

// Generate mixed +/-
function genMixedAddSub(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    if(Math.random()<0.5){arr.push(...genAdd(1,maxVal));}
    else{arr.push(...genSub(1,maxVal));}
  }
  return arr;
}

// Generate mixed ×/÷
function genMixedMulDiv(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    if(Math.random()<0.5){arr.push(...genMul(1,maxVal));}
    else{arr.push(...genDiv(1,maxVal));}
  }
  return arr;
}

// Generate fully mixed +,−,×,÷
function genMixedAll(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    const r=Math.random();
    if(r<0.25){arr.push(...genAdd(1,maxVal));}
    else if(r<0.5){arr.push(...genSub(1,maxVal));}
    else if(r<0.75){arr.push(...genMul(1,maxVal));}
    else{arr.push(...genDiv(1,maxVal));}
  }
  return arr;
}

// Render problems
function render(containerId, arr, prefix){
  const container=document.getElementById(containerId);
  arr.forEach((p,i)=>{
    container.innerHTML+=`
      <div class="problem">
        ${i+1}. ${p.q} = <input type="number" id="${prefix}${i}">
      </div>
    `;
  });
}

// ---------------- Lessons Data ----------------
const lessons=[
  {title:"# Lesson 1: Addition ≤100", problems:genAdd(10,100)},
  {title:"# Lesson 2: Subtraction ≤100", problems:genSub(10,100)},
  {title:"# Lesson 3: Multiplication ≤10", problems:genMul(10,10)},
  {title:"# Lesson 4: Division ≤10", problems:genDiv(10,10)},
  {title:"# Lesson 5: Mixed +/−", problems:genMixedAddSub(10,100)},
  {title:"# Lesson 6: Mixed ×/÷", problems:genMixedMulDiv(10,10)},
  {title:"# Lesson 7: Mixed all operations", problems:genMixedAll(10,20)},
  {title:"# Lesson 8: Review Mixed", problems:genMixedAll(10,50)}
];

// ---------------- Tests Data ----------------
const tests=[
  {title:"# Test 1", problems:genMixedAll(20,50)},
  {title:"# Test 2", problems:genMixedAll(20,50)},
  {title:"# Test 3", problems:genMixedAll(20,50)},
  {title:"# Test 4", problems:genMixedAll(20,50)},
  {title:"# Test 5", problems:genMixedAll(20,50)}
];

// ---------------- Render Lessons ----------------
const container=document.getElementById("content");
lessons.forEach((lesson,li)=>{
  container.innerHTML+=`<h3>${lesson.title}</h3>`;
  render("content",lesson.problems,`l${li}q`);
});

// ---------------- Render Tests ----------------
tests.forEach((test,ti)=>{
  container.innerHTML+=`<h3>${test.title}</h3>`;
  render("content",test.problems,`t${ti}q`);
});

// ---------------- Check All Answers ----------------
function checkAll(){
  let correct=0, total=0;
  lessons.forEach((lesson,li)=>{
    lesson.problems.forEach((p,pi)=>{
      const user=document.getElementById(`l${li}q${pi}`).value;
      if(parseInt(user)===p.a) correct++;
      total++;
    });
  });
  tests.forEach((test,ti)=>{
    test.problems.forEach((p,pi)=>{
      const user=document.getElementById(`t${ti}q${pi}`).value;
      if(parseInt(user)===p.a) correct++;
      total++;
    });
  });
  document.getElementById("score").textContent=`Score: ${correct} / ${total}`;
}
</script>

</body>
</html>
