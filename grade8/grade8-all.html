<!DOCTYPE html>
<html>
<head>
  <title>Grade 8 – Lessons & Tests</title>
  <style>
    body { font-family: Arial; background:#f4f7ff; padding:20px; text-align:center; }
    h1,h2,h3 { color:#333; }
    .problem { margin:8px; font-size:18px; }
    input { width:120px; padding:5px; font-size:16px; }
    button { margin:20px; padding:10px 18px; font-size:16px; cursor:pointer; }
    #score { margin-top:15px; font-size:18px; font-weight:bold; }
  </style>
</head>
<body>

<h1>Grade 8 – Lessons & Tests</h1>
<div id="content"></div>
<button onclick="checkAll()">Check All Answers</button>
<p id="score"></p>

<script>
// ---------------- Random Helpers ----------------
function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
function randDecimal(min,max,decimals=2){return parseFloat((Math.random()*(max-min)+min).toFixed(decimals));}

// ---------------- Arithmetic ----------------
function genAddSub(count,maxVal){
  const arr=[];
  for(let i=0;i<count;i++){
    const a=randDecimal(0,maxVal), b=randDecimal(0,maxVal);
    if(Math.random()<0.5) arr.push({q:`${a} + ${b}`,a:a+b});
    else arr.push({q:`${Math.max(a,b)} - ${Math.min(a,b)}`,a:Math.abs(a-b)});
  }
  return arr;
}

function genMulDiv(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const a=randDecimal(10,9999), b=randDecimal(1,999);
    if(Math.random()<0.5) arr.push({q:`${a} × ${b}`,a:a*b});
    else arr.push({q:`${a*b} ÷ ${b}`,a:a});
  }
  return arr;
}

// ---------------- Algebra ----------------
// Simple x + a = b
function genAlgebraSimple(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const x=randDecimal(1,500), a=randDecimal(0,500);
    arr.push({q:`x + ${a} = ${(x+a).toFixed(2)}`,a:x});
  }
  return arr;
}

// Multi-step: kx + a = b
function genAlgebraHard(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const x=randDecimal(1,200), k=randDecimal(1,20), a=randDecimal(0,200);
    const b=(k*x + a).toFixed(2);
    arr.push({q:`${k.toFixed(2)}x + ${a.toFixed(2)} = ${b}`,a:x});
  }
  return arr;
}

// Fractions: e.g., 1/2 x + a = b
function genAlgebraFraction(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const x=rand(1,50), numerator=rand(1,9), denominator=rand(2,9), a=rand(0,20);
    const b=(numerator/denominator*x + a).toFixed(2);
    arr.push({q:`(${numerator}/${denominator})x + ${a} = ${b}`,a:x});
  }
  return arr;
}

// Percentages: e.g., 20% of x + a = b
function genAlgebraPercent(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const x=rand(10,500), percent=rand(1,99), a=rand(0,100);
    const b=((percent/100)*x + a).toFixed(2);
    arr.push({q:`${percent}% of x + ${a} = ${b}`,a:x});
  }
  return arr;
}

// Mixed
function genMixedHard(count){
  const arr=[];
  for(let i=0;i<count;i++){
    const r=Math.random();
    if(r<0.2) arr.push(...genAddSub(1,5000));
    else if(r<0.4) arr.push(...genMulDiv(1));
    else if(r<0.55) arr.push(...genAlgebraSimple(1));
    else if(r<0.7) arr.push(...genAlgebraHard(1));
    else if(r<0.85) arr.push(...genAlgebraFraction(1));
    else arr.push(...genAlgebraPercent(1));
  }
  return arr;
}

// Render
function render(containerId, arr, prefix){
  const container=document.getElementById(containerId);
  arr.forEach((p,i)=>{
    container.innerHTML+=`<div class="problem">${i+1}. ${p.q} = <input type="number" step="0.01" id="${prefix}${i}"></div>`;
  });
}

// ---------------- Lessons ----------------
const lessons=[
  {title:"# Lesson 1: Addition/Subtraction Decimals", problems:genAddSub(10,5000)},
  {title:"# Lesson 2: Multiplication/Division Large Numbers", problems:genMulDiv(10)},
  {title:"# Lesson 3: Mixed Operations", problems:genMixedHard(10)},
  {title:"# Lesson 4: Simple Algebra", problems:genAlgebraSimple(10)},
  {title:"# Lesson 5: Multi-step Algebra", problems:genAlgebraHard(10)},
  {title:"# Lesson 6: Fractions & Decimals", problems:genAlgebraFraction(10)},
  {title:"# Lesson 7: Percentages", problems:genAlgebraPercent(10)},
  {title:"# Lesson 8: Challenge Multi-step", problems:genMixedHard(10)}
];

// ---------------- Tests ----------------
const tests=[
  {title:"# Test 1", problems:genMixedHard(20)},
  {title:"# Test 2", problems:genMixedHard(20)},
  {title:"# Test 3", problems:genMixedHard(20)},
  {title:"# Test 4", problems:genMixedHard(20)},
  {title:"# Test 5", problems:genMixedHard(20)}
];

// Render Lessons & Tests
const container=document.getElementById("content");
lessons.forEach((lesson,li)=>{container.innerHTML+=`<h3>${lesson.title}</h3>`; render("content",lesson.problems,`l${li}q`);});
tests.forEach((test,ti)=>{container.innerHTML+=`<h3>${test.title}</h3>`; render("content",test.problems,`t${ti}q`);});

// ---------------- Check ----------------
function checkAll(){
  let correct=0, total=0;
  lessons.forEach((lesson,li)=>{lesson.problems.forEach((p,pi)=>{
    const user=parseFloat(document.getElementById(`l${li}q${pi}`).value);
    if(Math.abs(user - p.a)<0.01) correct++; total++;
  });});
  tests.forEach((test,ti)=>{test.problems.forEach((p,pi)=>{
    const user=parseFloat(document.getElementById(`t${ti}q${pi}`).value);
    if(Math.abs(user - p.a)<0.01) correct++; total++;
  });});
  document.getElementById("score").textContent=`Score: ${correct} / ${total}`;
}
</script>

</body>
</html>
